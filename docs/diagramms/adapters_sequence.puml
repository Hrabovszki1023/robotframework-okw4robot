@startuml AdaptersSequence
title OKW4Robot – Sequenz: Start Host -> Start App -> Select Window -> SetValue

actor Tester as T
participant "HostKeywords" as HK
participant "AppKeywords" as AK
participant "WidgetKeywords" as WK
participant "Context" as C
participant "WebSe_TextField\n(OkwWidget)" as W
participant "SeleniumWebAdapter" as AD
participant "Browser/DOM" as DOM

' Start Host
T -> HK: Start Host("Chrome")
HK -> C: set_adapter(SeleniumWebAdapter(browser=chrome))
activate C
C --> HK: adapter set
deactivate C
HK -> AD: open browser about:blank (constructor)
AD -> DOM: open_browser

' Start App
T -> AK: Start App("web/WidgetsDemo")
AK -> C: set_app(app_name, app_model)
C --> AK: app set

' Select Window
T -> AK: Select Window("WidgetsDemo")
AK -> C: set_window("WidgetsDemo")
C --> AK: window set

' SetValue – Delegation!
T -> WK: SetValue("Name", "Alice")
WK -> C: get current app/window
WK -> WK: resolve_widget("Name")
note right: YAML class:\nokw_web_selenium.widgets\n.webse_textfield.WebSe_TextField
WK -> W: **okw_set_value("Alice")**
activate W
W -> W: _wait_before('write')
W -> AD: element_exists/visible/enabled/scroll/...
AD -> DOM: checks
W -> AD: clear_text(locator)
AD -> DOM: clear
W -> AD: input_text(locator, "Alice")
AD -> DOM: type
deactivate W
WK --> T: done

note right of WK
resolve_widget(name):
1) App-YAML -> class/locator/extras
2) adapter = Context.get_adapter()
3) return class(adapter, locator, **extras)
end note

note right of W
Delegation: Das Keyword ruft nur
widget.okw_set_value("Alice") auf.
Das Widget (WebSe_TextField) entscheidet
intern, wie es den Wert setzt
(clear + input_text via Adapter).
end note

@enduml
